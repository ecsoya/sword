<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="renderer" content="webkit">
<title>[[${config.name}]] - [[${config.title}]]</title>
<!-- 避免IE使用兼容模式 -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link th:href="@{favicon.ico}" rel="shortcut icon" />
<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" />
<link th:href="@{/css/jquery.contextMenu.min.css}" rel="stylesheet" />
<link th:href="@{/css/font-awesome.min.css}" rel="stylesheet" />
<link th:href="@{/css/animate.css}" rel="stylesheet" />
<link th:href="@{/css/style.css}" rel="stylesheet" />
<link th:href="@{/css/skins.css}" rel="stylesheet" />
<link th:href="@{/sword/css/ry-ui.css?v=4.6.0}" rel="stylesheet" />
<style type="text/css">
/** 动态主题 skin-primary **/
.navbar, .skin-primary .navbar {
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)










}
.skin-primary .navbar-default .nav>li.selected>a, .skin-primary .navbar-default .nav>li.selected>a:focus
	{
	background-color: #1890ff;
	color: rgba(255, 255, 255, 1);
}

.skin-primary .navbar .nav>li>a {
	color: #fff
}

.skin-primary .navbar .nav>li>a:hover, .skin-primary .navbar .nav>li>a:active,
	.skin-primary .navbar .nav>li>a:focus, .skin-primary .navbar .nav .open>a,
	.skin-primary .navbar .nav .open>a:hover, .skin-primary .navbar .nav .open>a:focus,
	.skin-primary .navbar .nav>.active>a {
	background: rgba(0, 0, 0, 0.1);
	color: #f6f6f6
}

.skin-primary .navbar .sidebar-toggle {
	color: #fff
}

.skin-primary .navbar .sidebar-toggle:hover {
	color: #f6f6f6;
	background: rgba(0, 0, 0, 0.1)
}

.skin-primary .navbar .sidebar-toggle {
	color: #fff
}

.skin-primary .navbar .sidebar-toggle:hover {
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)










}
@media ( max-width :767px) {
	.skin-primary .navbar .dropdown-menu li.divider {
		background-color: rgba(255, 255, 255, 0.1)
	}
	.skin-primary .navbar .dropdown-menu li a {
		color: #fff
	}
	.skin-primary .navbar .dropdown-menu li a:hover {
		background: rgb([[${@ config.global ( 'adminColor')
	}
	]]
	)
	
	
	
	
	
	




}

}
.skin-primary .logo {
	background-color: rgba([[${@ config.global ( 'adminColor')
}

]],
0








.8








)








;
color








:




 




#fff








;
border-bottom








:




 




0




 




solid




 




transparent










}
.skin-primary .logo:hover {
	background-color: #357ca5
}

.skin-primary li.user-header {
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)










}
.skin-primary .content-header {
	background: transparent
}

.skin-primary .wrapper, .skin-primary .main-sidebar, .skin-primary .left-side
	{
	background-color: #222d32
}

.skin-primary .user-panel>.info, .skin-primary .user-panel>.info>a {
	color: #fff
}

.skin-primary .nav>li.header {
	color: #4b646f;
	background: #1a2226
}

.skin-primary .nav:not(.navbar-toolbar)>li.active {
	color: #fff;
	background: #293846;
	border-left: 3px solid rgb([[${@ config.global ( 'adminColor')
}

]]
)








;
}
.skin-primary .nav>li.active>ul li.active {
	border-left: none;
}

.skin-primary .dropdown-menu>.active>a, .skin-primary .dropdown-menu>.active>a:hover,
	.skin-primary .dropdown-menu>.active>a:focus {
	color: #fff !important;
	text-decoration: none;
	outline: 0;
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)








;
}
.skin-primary .sidebar a {
	color: #b8c7ce
}

.skin-primary .sidebar a:hover {
	text-decoration: none
}

.skin-primary .sidebar-form {
	border-radius: 3px;
	border: 1px solid #374850;
	margin: 10px 10px
}

.skin-primary .sidebar-form input[type="text"], .skin-primary .sidebar-form .btn
	{
	box-shadow: none;
	background-color: #374850;
	border: 1px solid transparent;
	height: 35px
}

.skin-primary .sidebar-form input[type="text"] {
	color: #666;
	border-top-left-radius: 2px;
	border-top-right-radius: 0;
	border-bottom-right-radius: 0;
	border-bottom-left-radius: 2px
}

.skin-primary .sidebar-form input[type="text"]:focus, .skin-primary .sidebar-form input[type="text"]:focus+.input-group-btn .btn
	{
	background-color: #fff;
	color: #666
}

.skin-primary .sidebar-form input[type="text"]:focus+.input-group-btn .btn
	{
	border-left-color: #fff
}

.skin-primary .sidebar-form .btn {
	color: #999;
	border-top-left-radius: 0;
	border-top-right-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom-left-radius: 0
}

.skin-primary.layout-top-nav>.logo {
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)








;
color








:




 




#fff








;
border-bottom








:




 




0




 




solid




 




transparent










}
.skin-primary.layout-top-nav>.logo:hover {
	background-color: rgba([[${@ config.global ( 'adminColor')
}

]],
0








.8








)










}
.skin-primary .content-tabs {
	border-bottom: 1px solid #e5e5e5;
}

.skin-primary.layout-top-nav>.logo {
	background-color: rgb([[${@ config.global ( 'adminColor')
}

]]
)








;
color








:




 




#fff








;
border-bottom








:




 




0




 




solid




 




transparent










}
.skin-primary.layout-top-nav>.logo:hover {
	background-color: rgba([[${@ config.global ( 'adminColor')
}
]],
0








.8








)










}
</style>
</head>
<body class="fixed-sidebar full-height-layout gray-bg"
	style="overflow: hidden">
	<div id="wrapper">

		<!--左侧导航开始-->
		<nav class="navbar-default navbar-static-side" role="navigation">
			<div class="nav-close">
				<i class="fa fa-times-circle"></i>
			</div>
			<a th:href="@{/index}">
				<li class="logo hidden-xs"><span class="logo-lg">[[${config.name}]][[${config.title}]]</span>
			</li>
			</a>
			<div class="sidebar-collapse">
				<ul class="nav" id="side-menu">
					<li>
						<div class="user-panel">
							<a class="menuItem noactive" title="个人中心"
								th:href="@{/system/user/profile}">
								<div class="hide" th:text="个人中心"></div>
								<div class="pull-left image">
									<img
										th:src="(${#strings.isEmpty(user.avatar)}) ? @{/img/profile.jpg} : @{${user.avatar}}"
										th:onerror="this.src='img/profile.jpg'" class="img-circle"
										alt="User Image">
								</div>
							</a>
							<div class="pull-left info">
								<p>[[${user.loginName}]]</p>
								<a href="#"><i class="fa fa-circle text-success"></i> 在线</a> <a
									th:href="@{logout}" style="padding-left: 5px;"><i
									class="fa fa-sign-out text-danger"></i> 退出</a>
							</div>
						</div>
					</li>
					<li><a class="menuItem" th:href="@{/system/main}"><i
							class="fa fa-home"></i> <span class="nav-label">首页</span> </a></li>
					<li th:each="menu : ${menus}"><a
						th:class="@{${!#strings.isEmpty(menu.url) && menu.url != '#'} ? ${menu.target}}"
						th:href="@{${#strings.isEmpty(menu.url)} ? |#| : ${menu.url}}"
						th:data-refresh="${menu.isRefresh == '0'}"> <i
							class="fa fa-bar-chart-o" th:class="${menu.icon}"></i> <span
							class="nav-label" th:text="${menu.menuName}">一级菜单</span> <span
							th:class="${#strings.isEmpty(menu.url) || menu.url == '#'} ? |fa arrow|"></span>
					</a>
						<ul class="nav nav-second-level collapse">
							<li th:each="cmenu : ${menu.children}"><a
								th:if="${#lists.isEmpty(cmenu.children)}"
								th:class="${#strings.isEmpty(cmenu.target)} ? |menuItem| : ${cmenu.target}"
								th:href="@{${cmenu.url}}"
								th:data-refresh="${cmenu.isRefresh == '0'}"><i
									class="fa fa-bar-chart-o" th:class="${cmenu.icon}"></i>
									[[${cmenu.menuName}]]</a> <a
								th:if="${not #lists.isEmpty(cmenu.children)}" href="#">[[${cmenu.menuName}]]<span
									class="fa arrow"></span></a>
								<ul th:if="${not #lists.isEmpty(cmenu.children)}"
									class="nav nav-third-level">
									<li th:each="emenu : ${cmenu.children}"><a
										th:if="${#lists.isEmpty(emenu.children)}"
										th:class="${#strings.isEmpty(emenu.target)} ? |menuItem| : ${emenu.target}"
										th:text="${emenu.menuName}" th:href="@{${emenu.url}}"
										th:data-refresh="${emenu.isRefresh == '0'}">三级菜单</a> <a
										th:if="${not #lists.isEmpty(emenu.children)}" href="#">[[${emenu.menuName}]]<span
											class="fa arrow"></span></a>
										<ul th:if="${not #lists.isEmpty(emenu.children)}"
											class="nav nav-four-level">
											<li th:each="fmenu : ${emenu.children}"><a
												th:if="${#lists.isEmpty(fmenu.children)}"
												th:class="${#strings.isEmpty(fmenu.target)} ? |menuItem| : ${fmenu.target}"
												th:text="${fmenu.menuName}" th:href="@{${fmenu.url}}"
												th:data-refresh="${fmenu.isRefresh == '0'}">四级菜单</a></li>
										</ul></li>
								</ul></li>
						</ul></li>
				</ul>
			</div>
		</nav>
		<!--左侧导航结束-->

		<!--右侧部分开始-->
		<div id="page-wrapper" class="gray-bg dashbard-1">
			<div class="row border-bottom">
				<nav class="navbar navbar-static-top" role="navigation"
					style="margin-bottom: 0">
					<div class="navbar-header">
						<a class="navbar-minimalize minimalize-styl-2"
							style="color: #FFF;" href="#" title="收起菜单"> <i
							class="fa fa-bars"></i>
						</a>
					</div>
					<ul class="nav navbar-top-links navbar-right welcome-message">
						<li><a data-toggle="tooltip" data-trigger="hover"
							data-placement="bottom" title="锁定屏幕" href="#" id="lockScreen"><i
								class="fa fa-lock"></i> 锁屏</a></li>
						<li><a data-toggle="tooltip" data-trigger="hover"
							data-placement="bottom" title="全屏显示" href="#" id="fullScreen"><i
								class="fa fa-arrows-alt"></i> 全屏</a></li>
						<li th:if="${config.isMessageEnabled()}"> <a
							data-toggle="tooltip" data-trigger="hover"
							data-placement="bottom" title="系统消息" th:href="@{/message}"
							data-id="/message" class="menuItem"><i
								class="fa fa-envelope"></i> 消息 <span class="badge"
								id="messageBadge"
								style="display: none; background-color: red; color: white"></span></a></li>
						<li class="dropdown user-menu"><a href="javascript:void(0)"
							class="dropdown-toggle" data-hover="dropdown"> <img
								th:src="(${#strings.isEmpty(user.avatar)}) ? @{/img/profile.jpg} : @{${user.avatar}}"
								th:onerror="this.src='img/profile.jpg'" class="user-image">
								<span class="hidden-xs">[[${#strings.defaultString(user.userName,
									'-')}]]</span>
						</a>
							<ul class="dropdown-menu">
								<li class="mt5"><a th:href="@{/system/user/profile}"
									class="menuItem"> <i class="fa fa-user"></i> 个人中心
								</a></li>
								<li><a onclick="resetPwd()"> <i class="fa fa-key"></i>
										修改密码
								</a></li>
								<li><a onclick="switchSkin()"> <i
										class="fa fa-dashboard"></i> 切换主题
								</a></li>
								<li><a onclick="toggleMenu()"> <i
										class="fa fa-toggle-off"></i> 横向菜单
								</a></li>
								<li class="divider"></li>
								<li><a th:href="@{logout}"> <i class="fa fa-sign-out"></i>
										退出登录
								</a></li>
							</ul></li>
					</ul>
				</nav>
			</div>
			<div class="row content-tabs">
				<button class="roll-nav roll-left tabLeft">
					<i class="fa fa-backward"></i>
				</button>
				<nav class="page-tabs menuTabs">
					<div class="page-tabs-content">
						<a href="javascript:;" class="active menuTab"
							th:data-id="@{/system/main}">首页</a>
					</div>
				</nav>
				<button class="roll-nav roll-right tabRight">
					<i class="fa fa-forward"></i>
				</button>
				<a href="javascript:void(0);" class="roll-nav roll-right tabReload"><i
					class="fa fa-refresh"></i> 刷新</a>
			</div>

			<a id="ax_close_max" class="ax_close_max" href="#" title="关闭全屏">
				<i class="fa fa-times-circle-o"></i>
			</a>

			<div class="row mainContent" id="content-main"
				th:style="${#bools.isFalse(ignoreFooter)} ? |height: calc(100% - 91px)|">
				<iframe class="RuoYi_iframe" name="iframe0" width="100%"
					height="100%" th:data-id="@{/system/main}" th:src="@{/system/main}"
					frameborder="0" seamless></iframe>
			</div>

			<div th:if="${ignoreFooter}" class="footer">
				<div class="pull-right">
					Copyright ©[[${config.copyrightYear}]] [[${config.name}]]. All
					rights reserved. <small>V[[${config.version}]]</small>
				</div>
			</div>
		</div>
		<!--右侧部分结束-->
	</div>
	<!-- 全局js -->
	<script th:src="@{/js/jquery.min.js}"></script>
	<script th:src="@{/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
	<script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>
	<script th:src="@{/js/jquery.contextMenu.min.js}"></script>
	<script th:src="@{/ajax/libs/blockUI/jquery.blockUI.js}"></script>
	<script th:src="@{/ajax/libs/layer/layer.min.js}"></script>
	<script th:src="@{/sword/js/ry-ui.js?v=4.6.0}"></script>
	<script th:src="@{/sword/js/common.js?v=4.6.0}"></script>
	<script th:src="@{/sword/index.js?v=20201208}"></script>
	<script th:src="@{/ajax/libs/fullscreen/jquery.fullscreen.js}"></script>
	<th:block th:include="include :: websocket-js" />
	<script th:inline="javascript">
window.history.forward(1);
var ctx = [[@{/}]]; 
var lockscreen = [[${session.lockscreen}]]; 
if(lockscreen){window.top.location=ctx+"lockscreen";}
// 皮肤缓存
var skin = storage.get("skin");
// history（表示去掉地址的#）否则地址以"#"形式展示
var mode = "history";
// 历史访问路径缓存
var historyPath = storage.get("historyPath");
// 是否页签与菜单联动
var isLinkage = true;

// 本地主题优先，未设置取系统配置
if($.common.isNotEmpty(skin)){
	$("body").addClass(skin.split('|')[0]);
	$("body").addClass(skin.split('|')[1]);
} else {
	$("body").addClass([[${sideTheme}]]);
	$("body").addClass([[${skinName}]]);
}

/* 用户管理-重置密码 */
function resetPwd() {
    var url = ctx + 'system/user/profile/resetPwd';
    $.modal.open("重置密码", url, '770', '380');
}

/* 切换主题 */
function switchSkin() {
    layer.open({
		type : 2,
		shadeClose : true,
		title : "切换主题",
		area : ["530px", "386px"],
		content : [ctx + "system/switchSkin", 'no']
	})
}

/* 切换菜单 */
function toggleMenu() {
	$.modal.confirm("确认要切换成横向菜单吗？", function() {
		$.get(ctx + 'system/menuStyle/topnav', function(result) {
            window.location.reload();
	    });
	})
}

/** 刷新时访问路径页签 */
function applyPath(url) {
	$('a[href$="' + decodeURI(url) + '"]').click();
	if (!$('a[href$="' + url + '"]').hasClass("noactive")) {
	    $('a[href$="' + url + '"]').parent("li").addClass("selected").parents("li").addClass("active").end().parents("ul").addClass("in");
	}
}

$(function() {
	if($.common.equals("history", mode) && window.performance.navigation.type == 1) {
		var url = storage.get('publicPath');
	    if ($.common.isNotEmpty(url)) {
	    	applyPath(url);
	    }
	} else {
		var hash = location.hash;
	    if ($.common.isNotEmpty(hash)) {
	        var url = hash.substring(1, hash.length);
	        applyPath(url);
	    } else {
	    	if($.common.equals("history", mode)) {
	    		storage.set('publicPath', "");
	    	}
	    }
	}
	
	/* 初始密码提示 */
	if([[${isDefaultModifyPwd}]]) {
		layer.confirm("您的密码还是初始密码，请修改密码！", {
			icon: 0,
			title: "安全提示",
			btn: ['确认'	, '取消'],
			offset: ['30%']
		}, function (index) {
			resetPwd();
			layer.close(index);
		});
	}
	
	/* 过期密码提示 */
	if([[${isPasswordExpired}]]) {
		layer.confirm("您的密码已过期，请尽快修改密码！", {
			icon: 0,
			title: "安全提示",
			btn: ['确认'	, '取消'],
			offset: ['30%']
		}, function (index) {
			resetPwd();
			layer.close(index);
		});
	}
	$("[data-toggle='tooltip']").tooltip();
	
	var messageEnabled = [[${config.isMessageEnabled()}]];
	if (messageEnabled) {
		//websocket
		connectWebSocket(function(event){
			if (!event || event.code=='2') {
				return;
			}
			$.get(ctx + 'message/count', function(count){
				if (count) {
					$('#messageBadge').html(count);
					$('#messageBadge').show();
				} else {
					$('#messageBadge').hide();
				}
			})
		})
	}
});

function openMessages() {
	$.modal.openTab('系统消息', ctx + 'message');
}
</script>
</body>
</html>
